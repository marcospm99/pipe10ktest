Page 1           Source Listing                                                                
2023-01-27 11:38                                 /tmp/iforta4l3qR.i90

./program/timestep.f90(203): remark #7712: This variable has not been used.   [D
      double precision :: dterr, d
---------------------------------^

Page 2           Source Listing                  TIM_PRECOMPUTE
2023-01-27 11:38                                 /tmp/iforta4l3qR.i90

      1 # 1 "./program/timestep.f90"
      2 !*************************************************************************
      3 !
      4 !
      5 !*************************************************************************
      6 # 1 "./program/../parallel.h" 1 
      7 
      8 
      9 
     10  
     11 
     12 
     13 
     14  
     15 
     16  
     17 
     18 # 14
     19 
     20 
     21 
     22 
     23 
     24 
     25  
     26 # 23
     27 
     28 
     29  
     30 # 44
     31 
     32  
     33 
     34 
     35 
     36 # 54
     37 
     38          
     39 
     40 
     41  
     42 
     43  
     44 
     45 
     46 # 6 "./program/timestep.f90" 2 
     47  module timestep
     48 !*************************************************************************
     49    use variables
     50    implicit none
     51    save
     52 
     53    double precision :: tim_t
     54    double precision :: tim_dt
     55    double precision :: tim_dterr
     56    integer          :: tim_it
     57    integer          :: tim_step

Page 3           Source Listing                  TIM_PRECOMPUTE
2023-01-27 11:38                                 ./program/timestep.f90

     58    double precision :: tim_corr_dt
     59    double precision :: tim_cfl_dt
     60    integer          :: tim_cfl_dir
     61    logical          :: tim_new_dt
     62    integer          :: tim_pcn
     63 
     64  contains
     65 
     66 !------------------------------------------------------------------------
     67 !  set the initial time and timestep,
     68 !  possibly overwritten by loading a previously saved state
     69 !------------------------------------------------------------------------
     70    subroutine tim_precompute()
     71       tim_t       = d_time
     72       tim_dt      = d_timestep
     73       tim_dterr   = 0d0
     74       tim_it      = 0
     75       tim_step    = 0
     76       tim_corr_dt = 0d0
     77       tim_cfl_dt  = 0d0
     78       tim_cfl_dir = 0
     79       tim_new_dt  = .false.
     80       tim_pcn     = -1
     81    end subroutine tim_precompute


ENTRY POINTS

  Name                                   
                                         
 timestep_mp_tim_precompute_             

Page 4           Source Listing                  TIM_PRECOMPUTE
2023-01-27 11:38 Symbol Table                    ./program/timestep.f90



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 D_TIME                     Param  71       R(8)            8           scalar                    71                                
 D_TIMESTEP                 Param  72       R(8)            8           scalar                    72,278,279,295,296                
 TIM_CFL_DIR                Local  78       I(4)            4           scalar   SAVE             78                                
 TIM_CFL_DT                 Local  77       R(8)            8           scalar   SAVE             77,314,315                        
 TIM_CORR_DT                Local  76       R(8)            8           scalar   SAVE             76,267,288,313,316                
 TIM_DT                     Local  72       R(8)            8           scalar   SAVE             72,267,271,279,288,296,312,319,320
                                                                                                  ,321,323,324                      
 TIM_DTERR                  Local  73       R(8)            8           scalar   SAVE             73,255,267,285,287,288,290,291,300
 TIM_IT                     Local  74       I(4)            4           scalar   SAVE             74,266,274,275,276,281,284,289,292
                                                                                                  ,295,298                          
 TIM_NEW_DT                 Local  79       L(4)            4           scalar   SAVE             79,319,322                        
 TIM_PCN                    Local  80       I(4)            4           scalar   SAVE             80,275                            
 TIM_PRECOMPUTE             Subr   70                                                                                               
 TIM_STEP                   Local  75       I(4)            4           scalar   SAVE             75,271,273,277,278,279,283,287,294
                                                                                                  ,295,296,313                      
 TIM_T                      Local  71       R(8)            8           scalar   SAVE             71                                

Page 5           Source Listing                  TIM_PRECOMPUTE
2023-01-27 11:38                                 ./program/timestep.f90

     82 
     83 
     84 !------------------------------------------------------------------------
     85 !  Sets  A = c1 I + c2 Lap,   if PM=+-1 modified Lap for u+,u-
     86 !------------------------------------------------------------------------
     87    subroutine tim_mesh_init(PM,c1,c2, A)
     88       integer,          intent(in)  :: PM
     89       double precision, intent(in)  :: c1,c2
     90       type (mesh),      intent(out) :: A(0:i_pH1)
     91       double precision :: d(i_N)
     92       integer :: nh,k,m
     93       
     94       nh = -1;    do m = 0, i_M1;     do k = -i_K1, i_K1;      if(k<0 .and. m==0) cycle;      nh = nh  + 1
     95          d = -mes_D%r(:,-2)*i_Mp*m*i_Mp*m - d_alpha*k*d_alpha*k
     96          if(PM/=0) d = d - mes_D%r(:,-2) - 2d0*PM*i_Mp*m*mes_D%r(:,-2)
     97          A(nh)%M = c2 * mes_D%radLap%M
     98          A(nh)%M(i_KL+1,1:) = A(nh)%M(i_KL+1,1:) + c2*d + c1 
     99       end do;  end do
    100 
    101    end subroutine tim_mesh_init


ENTRY POINTS

  Name                                  
                                        
 timestep_mp_tim_mesh_init_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 A                          Dummy  87       RECORD          14112 1     523776   ARG,OUT          97,98                             
 C1                         Dummy  87       R(8)            8           scalar   ARG,IN           98                                
 C2                         Dummy  87       R(8)            8           scalar   ARG,IN           97,98                             
 D                          Local  91       R(8)            8     1     192                       95,96,98                          
 D_ALPHA                    Local  95       R(8)            8           scalar   SAVE             95,117                            
 I_K1                       Param  94       I(4)            4           scalar                    94,116,154,185                    
 I_KL                       Param  98       I(4)            4           scalar                    98,119,120,125,126,127,128,132,133
                                                                                                  ,137,160,163,180,186,187,196,197,1
                                                                                                  98,200,201                        
 I_M1                       Param  94       I(4)            4           scalar                    94,116,154,185                    
 I_MP                       Param  95       I(4)            4           scalar                    95,96,117,118,123,188             
 I_N                        Param  91       I(4)            4           scalar                    91,112,132,133,137,160,161,163,164
                                                                                                  ,180,181,196,198,218,219          
 I_PH1                      Param  90       I(4)            4           scalar                    90,111,149,178                    
 K                          Local  92       I(4)            4           scalar                    94,95                             
 M                          Local  92       I(4)            4           scalar                    94,95,96                          
 MESH                       Type   90                                   scalar                    90,178                            
 MES_D                      Local  95       RDOM            83272       scalar   SAVE             95,96,97,117,118,119,128,133      
 NH                         Local  92       I(4)            4           scalar                    94,97,98                          
 PM                         Dummy  87       I(4)            4           scalar   ARG,IN           96                                
 TIM_MESH_INIT              Subr   87                                                                                               



Page 6           Source Listing                  TIM_MESH_INIT
2023-01-27 11:38 Symbol Table                    ./program/timestep.f90

TYPE COMPONENTS/COMMON VARIABLES

 Name                       Type            Bytes Offset   Dimen Elements Attributes       References                         
                                                                                                                              
 MESH.M                     R(8)            8     0        2     1764                      97,98,119,128,200,201              
 RDOM.R                     R(8)            8     24       2     1344                      95,96,117,118                      
 RDOM.RADLAP                MESH            14112 69160          scalar                    97,119,128                         

Page 7           Source Listing                  TIM_MESH_INIT
2023-01-27 11:38                                 ./program/timestep.f90

    102 
    103 
    104 !------------------------------------------------------------------------
    105 !  Sets  A = c1 I + c2 Lap(h)  then replaces A with its LU factorisation
    106 !  if PM==0 usual laplacian, PM==-1/1 modified laplacian
    107 !------------------------------------------------------------------------
    108    subroutine tim_lumesh_init(PM,BC,c1,c2, A)
    109       integer,          intent(in)  :: PM,BC
    110       double precision, intent(in)  :: c1,c2
    111       type (lumesh),    intent(out) :: A(0:i_pH1)
    112       double precision :: d(i_N)
    113       integer :: info, n,j, S
    114       integer :: nh,k,m
    115       
    116       nh = -1;    do m = 0, i_M1;     do k = -i_K1, i_K1;      if(k<0 .and. m==0) cycle;      nh = nh  + 1
    117          d = -mes_D%r(:,-2)*i_Mp*m*i_Mp*m - d_alpha*k*d_alpha*k
    118          if(PM/=0) d = d - mes_D%r(:,-2) - 2d0*PM*i_Mp*m*mes_D%r(:,-2)
    119          A(nh)%M(i_KL+1:, :) = c2 * mes_D%radLap%M(:,1:)
    120          A(nh)%M(2*i_KL+1,:) = A(nh)%M(2*i_KL+1,:) + c2*d + c1 
    121 
    122 ! assume symmetry on axis: S==-1 mode odd,  S==1 mode even
    123          S = modulo(m*i_Mp+abs(PM),2)
    124          S = 1 - 2*S
    125          do j = 1, i_KL
    126             do n = 1, i_KL+1-j
    127                A(nh)%M(2*i_KL+1+n-j, j) = A(nh)%M(2*i_KL+1+n-j, j)  &
    128                   + c2 * S * mes_D%radLap%M(i_KL+1+n-(1-j), (1-j))
    129             end do
    130          end do
    131 ! boundary condition
    132          do j = i_N-i_KL, i_N
    133             A(nh)%M(2*i_KL+1+i_N-j,j) = mes_D%dr1(i_KL-i_N+j+1,BC) 
    134          end do
    135          if(BC==1 .and. k==0 .and. m==0) cycle
    136 
    137          call dgbtrf(i_N,i_N,i_KL,i_KL,A(nh)%M,3*i_KL+1,A(nh)%ipiv,info)
    138          if(info /= 0) stop 'tim_lumesh_init'
    139       end do;  end do
    140 
    141    end subroutine tim_lumesh_init

Page 8           Source Listing                  TIM_LUMESH_INIT
2023-01-27 11:38 Entry Points                    ./program/timestep.f90



ENTRY POINTS

  Name                                    
                                          
 timestep_mp_tim_lumesh_init_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 A                          Dummy  108      RECORD          20736 1     523776   ARG,OUT          119,120,127,133,137               
 ABS                        Func   123                                  scalar                    123                               
 BC                         Dummy  108      I(4)            4           scalar   ARG,IN           133,135                           
 C1                         Dummy  108      R(8)            8           scalar   ARG,IN           120                               
 C2                         Dummy  108      R(8)            8           scalar   ARG,IN           119,120,128                       
 D                          Local  112      R(8)            8     1     192                       117,118,120                       
 DGBTRF                     Subr   137                                                            137                               
 INFO                       Local  113      I(4)            4           scalar                    137,138                           
 J                          Local  113      I(4)            4           scalar                    125,126,127,128,132,133           
 K                          Local  114      I(4)            4           scalar                    116,117,135                       
 LUMESH                     Type   111                                  scalar                    111,149                           
 M                          Local  114      I(4)            4           scalar                    116,117,118,123,135               
 MODULO                     Func   123                                  scalar                    123                               
 N                          Local  113      I(4)            4           scalar                    126,127,128                       
 NH                         Local  114      I(4)            4           scalar                    116,119,120,127,133,137           
 PM                         Dummy  108      I(4)            4           scalar   ARG,IN           118,123                           
 S                          Local  113      I(4)            4           scalar                    123,124,128                       
 TIM_LUMESH_INIT            Subr   108                                                                                              


TYPE COMPONENTS/COMMON VARIABLES

 Name                       Type            Bytes Offset   Dimen Elements Attributes       References                         
                                                                                                                              
 LUMESH.IPIV                I(4)            4     0        1     192                       137,161,164                        
 LUMESH.M                   R(8)            8     768      2     2496                      119,120,127,133,137,160,163        
 RDOM.DR1                   R(8)            8     12512    2     25                        133                                

Page 9           Source Listing                  TIM_LUMESH_INIT
2023-01-27 11:38                                 ./program/timestep.f90

    142 
    143 
    144 !------------------------------------------------------------------------
    145 !  solve system Ax=y for x, replaces b;  uses lapack routine dgbtrs()
    146 !------------------------------------------------------------------------
    147    subroutine tim_lumesh_invert(BC,A, b)
    148       integer,       intent(in)    :: BC
    149       type (lumesh), intent(in)    :: A(0:i_pH1)
    150       type (coll),   intent(inout) :: b
    151       integer :: info
    152       integer :: nh,k,m
    153 
    154       nh = -1;    do m = 0, i_M1;     do k = -i_K1, i_K1;      if(k<0 .and. m==0) cycle;      nh = nh  + 1
    155          if(BC==1 .and. k==0 .and. m==0) then
    156             b%Re(:,nh) = 0d0
    157             b%Im(:,nh) = 0d0         
    158             cycle
    159          end if 
    160          call dgbtrs('N', i_N, i_KL, i_KL, 1, A(nh)%M, 3*i_KL+1,  &
    161                      A(nh)%ipiv, b%Re(1,nh), i_N, info )
    162          if(info/=0) stop 'mes_lumesh_invert.1'
    163          call dgbtrs('N', i_N, i_KL, i_KL, 1, A(nh)%M, 3*i_KL+1,  &
    164                      A(nh)%ipiv, b%Im(1,nh), i_N, info )
    165          if(info/=0) stop 'mes_lumesh_invert.2'
    166       end do;  end do
    167    
    168    end subroutine tim_lumesh_invert


ENTRY POINTS

  Name                                      
                                            
 timestep_mp_tim_lumesh_invert_             

Page 10          Source Listing                  TIM_LUMESH_INVERT
2023-01-27 11:38 Symbol Table                    ./program/timestep.f90



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 A                          Dummy  147      RECORD          20736 1     523776   ARG,IN           160,161,163,164                   
 B                          Dummy  147      COLL            16090       scalar   ARG,INOUT        156,157,161,164                   
                                                            39872                                                                   
 BC                         Dummy  147      I(4)            4           scalar   ARG,IN           155                               
 COLL                       Type   150                                  scalar                    150,177,179,215,227,228,243       
 DGBTRS                     Subr   160                                                            160,163                           
 INFO                       Local  151      I(4)            4           scalar                    161,162,164,165                   
 K                          Local  152      I(4)            4           scalar                    154,155                           
 M                          Local  152      I(4)            4           scalar                    154,155                           
 NH                         Local  152      I(4)            4           scalar                    154,156,157,160,161,163,164       
 TIM_LUMESH_INVERT          Subr   147                                                                                              


TYPE COMPONENTS/COMMON VARIABLES

 Name                       Type            Bytes Offset   Dimen Elements Attributes       References                         
                                                                                                                              
 COLL.IM                    R(8)            8     80451993 2     10056499                  157,164,187,193,195,205,219,235,24 
                                                  6              2                         9,250,251                          
 COLL.RE                    R(8)            8     0        2     10056499                  156,161,186,192,194,204,218,234,24 
                                                                 2                         9,250,251                          

Page 11          Source Listing                  TIM_LUMESH_INVERT
2023-01-27 11:38                                 ./program/timestep.f90

    169 
    170 
    171 !------------------------------------------------------------------------
    172 !  multiply  d = A b + c
    173 !  S=0, b even for m even; S=1, b odd for m even
    174 !------------------------------------------------------------------------
    175    subroutine tim_meshmult(S,A,b,c, d)
    176       integer,     intent(in)  :: S
    177       type (coll), intent(in)  :: b,c
    178       type (mesh), intent(in)  :: A(0:i_pH1)
    179       type (coll), intent(out) :: d
    180       double precision :: bRe(1-i_KL:i_N), bIm(1-i_KL:i_N)
    181       double precision :: re(i_N), im(i_N)
    182       integer :: j,nl,nr,n
    183       integer :: nh,k,m
    184 
    185       nh = -1;    do m = 0, i_M1;     do k = -i_K1, i_K1;      if(k<0 .and. m==0) cycle;      nh = nh  + 1
    186          bRe(:0) = b%Re(i_KL:1:-1,nh)
    187          bIm(:0) = b%Im(i_KL:1:-1,nh)
    188          if(modulo(m*i_Mp+S,2)==1) then
    189             bRe(:0) = - bRe(:0)
    190             bIm(:0) = - bIm(:0)
    191          end if
    192          bRe(1:) = b%Re(:,nh)
    193          bIm(1:) = b%Im(:,nh)
    194          re = c%Re(:,nh)
    195          im = c%Im(:,nh)
    196          do j = 1-i_KL, i_N
    197             nl = max(1,j-i_KL)
    198             nr = min(j+i_KL,i_N)
    199             do n = nl, nr
    200                re(n) = re(n) + A(nh)%M(i_KL+1+n-j,j) * bRe(j)
    201                im(n) = im(n) + A(nh)%M(i_KL+1+n-j,j) * bIm(j)
    202             end do
    203          end do
    204          d%Re(:,nh) = re
    205          d%Im(:,nh) = im
    206       end do;  end do
    207  
    208    end subroutine tim_meshmult

Page 12          Source Listing                  TIM_MESHMULT
2023-01-27 11:38 Entry Points                    ./program/timestep.f90



ENTRY POINTS

  Name                                 
                                       
 timestep_mp_tim_meshmult_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 A                          Dummy  175      RECORD          14112 1     523776   ARG,IN           200,201                           
 B                          Dummy  175      COLL            16090       scalar   ARG,IN           186,187,192,193                   
                                                            39872                                                                   
 BIM                        Local  180      R(8)            8     1     196                       187,190,193,201                   
 BRE                        Local  180      R(8)            8     1     196                       186,189,192,200                   
 C                          Dummy  175      COLL            16090       scalar   ARG,IN           194,195                           
                                                            39872                                                                   
 D                          Dummy  175      COLL            16090       scalar   ARG,OUT          204,205                           
                                                            39872                                                                   
 IM                         Local  181      R(8)            8     1     192                       195,201,205                       
 J                          Local  182      I(4)            4           scalar                    196,197,198,200,201               
 K                          Local  183      I(4)            4           scalar                    185                               
 M                          Local  183      I(4)            4           scalar                    185,188                           
 MAX                        Func   197                                  scalar                    197                               
 MIN                        Func   198                                  scalar                    198                               
 MODULO                     Func   188                                  scalar                    188                               
 N                          Local  182      I(4)            4           scalar                    199,200,201                       
 NH                         Local  183      I(4)            4           scalar                    185,186,187,192,193,194,195,200,20
                                                                                                  1,204,205                         
 NL                         Local  182      I(4)            4           scalar                    197,199                           
 NR                         Local  182      I(4)            4           scalar                    198,199                           
 RE                         Local  181      R(8)            8     1     192                       194,200,204                       
 S                          Dummy  175      I(4)            4           scalar   ARG,IN           188                               
 TIM_MESHMULT               Subr   175                                                                                              

Page 13          Source Listing                  TIM_MESHMULT
2023-01-27 11:38                                 ./program/timestep.f90

    209 
    210 
    211 !-------------------------------------------------------------------------
    212 !  set the RHS for the boundary condition = 0
    213 !-------------------------------------------------------------------------
    214    subroutine tim_zerobc(a)
    215       type (coll), intent(out) :: a
    216       integer :: n
    217       do n = 0, var_H%pH1
    218          a%Re(i_N, n ) = 0d0
    219          a%Im(i_N, n ) = 0d0
    220       end do
    221    end subroutine tim_zerobc


ENTRY POINTS

  Name                               
                                     
 timestep_mp_tim_zerobc_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 A                          Dummy  214      COLL            16090       scalar   ARG,OUT          218,219                           
                                                            39872                                                                   
 N                          Local  216      I(4)            4           scalar                    217,218,219                       
 TIM_ZEROBC                 Subr   214                                                                                              
 VAR_H                      Local  217      HARM            16          scalar   SAVE             217,233,247                       


TYPE COMPONENTS/COMMON VARIABLES

 Name                       Type            Bytes Offset   Dimen Elements Attributes       References                         
                                                                                                                              
 HARM.PH1                   I(4)            4     4              scalar                    217,233,247                        

Page 14          Source Listing                  TIM_ZEROBC
2023-01-27 11:38                                 ./program/timestep.f90

    222 
    223 !-------------------------------------------------------------------------
    224 !  corrected "implicit" nonlinear terms
    225 !-------------------------------------------------------------------------
    226    subroutine tim_nlincorr(N_, N)
    227       type (coll), intent(in)    :: N_
    228       type (coll), intent(inout) :: N
    229       double precision :: d1,d2
    230       integer :: nhm
    231       d1 = d_implicit
    232       d2 = 1d0 - d_implicit
    233       nhm = var_H%pH1
    234       N%Re(:,0:nhm) = d1 * N%Re(:,0:nhm) + d2 * N_%Re(:,0:nhm)
    235       N%Im(:,0:nhm) = d1 * N%Im(:,0:nhm) + d2 * N_%Im(:,0:nhm)
    236    end subroutine tim_nlincorr


ENTRY POINTS

  Name                                 
                                       
 timestep_mp_tim_nlincorr_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 D1                         Local  229      R(8)            8           scalar                    231,234,235                       
 D2                         Local  229      R(8)            8           scalar                    232,234,235                       
 D_IMPLICIT                 Param  231      R(8)            8           scalar                    231,232                           
 N                          Dummy  226      COLL            16090       scalar   ARG,INOUT        234,235                           
                                                            39872                                                                   
 NHM                        Local  230      I(4)            4           scalar                    233,234,235                       
 N_                         Dummy  226      COLL            16090       scalar   ARG,IN           234,235                           
                                                            39872                                                                   
 TIM_NLINCORR               Subr   226                                                                                              

Page 15          Source Listing                  TIM_NLINCORR
2023-01-27 11:38                                 ./program/timestep.f90

    237       
    238 
    239 !-------------------------------------------------------------------------
    240 !  measure the magnutude of the correction: max diff
    241 !-------------------------------------------------------------------------
    242    subroutine tim_measurecorr(c1,c2,c3)
    243       type (coll), intent(in)    :: c1,c2,c3
    244       double precision :: dterr, d
	.................................1 
(1) This variable has not been used.   [D]

    245       integer :: nh
    246       dterr = 0d0
    247       do nh = 0, var_H%pH1
    248          dterr = max(dterr,  &
    249             maxval( c1%Re(:,nh)*c1%Re(:,nh) + c1%Im(:,nh)*c1%Im(:,nh)),  &
    250             maxval( c2%Re(:,nh)*c2%Re(:,nh) + c2%Im(:,nh)*c2%Im(:,nh)),  &
    251             maxval( c3%Re(:,nh)*c3%Re(:,nh) + c3%Im(:,nh)*c3%Im(:,nh)) )
    252       end do
    253 # 216
    254 
    255       tim_dterr = max(tim_dterr,dsqrt(dterr))
    256    end subroutine tim_measurecorr


ENTRY POINTS

  Name                                    
                                          
 timestep_mp_tim_measurecorr_             

Page 16          Source Listing                  TIM_MEASURECORR
2023-01-27 11:38 Symbol Table                    ./program/timestep.f90



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 C1                         Dummy  242      COLL            16090       scalar   ARG,IN           249                               
                                                            39872                                                                   
 C2                         Dummy  242      COLL            16090       scalar   ARG,IN           250                               
                                                            39872                                                                   
 C3                         Dummy  242      COLL            16090       scalar   ARG,IN           251                               
                                                            39872                                                                   
 D                          Local  244      R(8)            8           scalar                                                      
 DSQRT                      Func   255                                  scalar                    255                               
 DTERR                      Local  244      R(8)            8           scalar                    246,248,255                       
 MAX                        Func   248                                  scalar                    248,255                           
 MAXVAL                     Func   249                                  scalar                    249,250,251                       
 NH                         Local  245      I(4)            4           scalar                    247,249,250,251                   
 TIM_MEASURECORR            Subr   242                                                                                              

Page 17          Source Listing                  TIM_MEASURECORR
2023-01-27 11:38                                 ./program/timestep.f90

    257 
    258 
    259 !-------------------------------------------------------------------------
    260 !  check for convergence via the 2-norm of the correction
    261 !  -- see tim_addcorr()
    262 !-------------------------------------------------------------------------
    263    subroutine tim_check_cgce()
    264       double precision, save :: lasterr
    265       
    266       if(tim_it==1) then
    267          tim_corr_dt = tim_dt * dsqrt( d_dterr/tim_dterr )
    268          lasterr = 1d99
    269       end if         
    270 
    271       if(tim_dt<1d-9 .and. tim_step>30) then
    272          if(mpi_rnk==0) print*, 'tim_check_cgce: dt --> 0 !!!?'
    273          tim_step = i_maxtstep-1
    274          tim_it = 0
    275       else if(tim_it==tim_pcn) then
    276          tim_it = 0
    277          if(mpi_rnk==0 .and. modulo(tim_step,i_save_rate2)==0) then
    278             if(d_timestep> 0d0) print*,' step=',tim_step
    279             if(d_timestep<=0d0) print*,' step=',tim_step,' dt=',real(tim_dt)
    280          end if
    281       else if(tim_it>10) then
    282          if(mpi_rnk==0) print*, 'tim_check_cgce: too many its!!!'
    283          tim_step = i_maxtstep-1
    284          tim_it = 0
    285       else if(tim_dterr>lasterr) then
    286          if(mpi_rnk==0) print*, 'tim_check_cgce: increasing error!!!'
    287          if(tim_dterr>2d0*d_dterr) tim_step = i_maxtstep-1
    288          if(tim_dterr<2d0*d_dterr) tim_corr_dt = tim_dt/(1d1*d_courant)
    289          tim_it = 0
    290       else if(tim_dterr>d_dterr) then
    291          lasterr = tim_dterr
    292          tim_it = tim_it + 1
    293       else          
    294          if(mpi_rnk==0 .and. modulo(tim_step,i_save_rate2)==0) then
    295             if(d_timestep> 0d0) print*,' step=',tim_step,' its=',tim_it
    296             if(d_timestep<=0d0) print*,' step=',tim_step,' dt=',real(tim_dt)
    297          end if
    298          tim_it = 0
    299       end if
    300       tim_dterr = 0d0
    301       
    302    end subroutine tim_check_cgce

Page 18          Source Listing                  TIM_CHECK_CGCE
2023-01-27 11:38 Entry Points                    ./program/timestep.f90



ENTRY POINTS

  Name                                   
                                         
 timestep_mp_tim_check_cgce_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DSQRT                      Func   267                                  scalar                    267                               
 D_COURANT                  Param  288      R(8)            8           scalar                    288,315                           
 D_DTERR                    Param  267      R(8)            8           scalar                    267,287,288,290                   
 I_MAXTSTEP                 Param  273      I(4)            4           scalar                    273,283,287                       
 I_SAVE_RATE2               Param  277      I(4)            4           scalar                    277,294                           
 LASTERR                    Local  264      R(8)            8           scalar   SAVE             268,285,291                       
 MODULO                     Func   277                                  scalar                    277,294                           
 MPI_RNK                    Local  272      I(4)            4           scalar   SAVE             272,277,282,286,294               
 REAL                       Func   279                                  scalar                    279,296                           
 TIM_CHECK_CGCE             Subr   263                                                                                              

Page 19          Source Listing                  TIM_CHECK_CGCE
2023-01-27 11:38                                 ./program/timestep.f90

    303 
    304 
    305 !-------------------------------------------------------------------------
    306 !  set a new timestep size, if necessary.
    307 !-------------------------------------------------------------------------
    308    subroutine tim_new_tstep()
    309       double precision :: dt
    310       integer, save :: i = 0
    311 
    312       dt = min(tim_dt*1.11d0, d_maxdt)
    313       if(tim_step==0d0 .and. tim_corr_dt==0d0)  &
    314                            dt = min(dt, tim_cfl_dt*0.1d0)
    315       if(tim_cfl_dt >0d0)  dt = min(dt, tim_cfl_dt*d_courant)
    316       if(tim_corr_dt>0d0)  dt = min(dt, tim_corr_dt*0.95d0)
    317       
    318       i = i - 1
    319       tim_new_dt = ( dt<tim_dt*0.95d0  &
    320               .or.  (dt>tim_dt*1.10d0 .and. i<0)  &
    321               .or.  (dt==d_maxdt .and. tim_dt<dt .and. i<0) )
    322       if(tim_new_dt) then
    323          if(dt>=tim_dt)  i = 99
    324          tim_dt = dt
    325       end if
    326       
    327    end subroutine tim_new_tstep


ENTRY POINTS

  Name                                  
                                        
 timestep_mp_tim_new_tstep_             

Page 20          Source Listing                  TIM_NEW_TSTEP
2023-01-27 11:38 Symbol Table                    ./program/timestep.f90



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 DT                         Local  309      R(8)            8           scalar                    312,314,315,316,319,320,321,323,32
                                                                                                  4                                 
 D_MAXDT                    Param  312      R(8)            8           scalar                    312,321                           
 I                          Local  310      I(4)            4           scalar   SAVE             310,318,320,321,323               
 MIN                        Func   312                                  scalar                    312,314,315,316                   
 TIM_NEW_TSTEP              Subr   308                                                                                              

Page 21          Source Listing                  TIM_NEW_TSTEP
2023-01-27 11:38 Symbol Table                    ./program/timestep.f90



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 TIMESTEP                   Module 47                                                                                               
 VARIABLES                  Module 49                                                             49                                

Page 22          Source Listing                  TIM_NEW_TSTEP
2023-01-27 11:38                                 ./program/timestep.f90

    328 
    329 
    330 !*************************************************************************
    331  end module timestep
    332 !*************************************************************************
    333 

Page 23          Source Listing                  TIM_NEW_TSTEP
2023-01-27 11:38 Subprograms/Common Blocks       ./program/timestep.f90



SUBPROGRAMS/COMMON BLOCKS

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 TIMESTEP                   Module 47                                                                                               
 TIM_CHECK_CGCE             Subr   263                                                                                              
 TIM_LUMESH_INIT            Subr   108                                                                                              
 TIM_LUMESH_INVERT          Subr   147                                                                                              
 TIM_MEASURECORR            Subr   242                                                                                              
 TIM_MESHMULT               Subr   175                                                                                              
 TIM_MESH_INIT              Subr   87                                                                                               
 TIM_NEW_TSTEP              Subr   308                                                                                              
 TIM_NLINCORR               Subr   226                                                                                              
 TIM_PRECOMPUTE             Subr   70                                                                                               
 TIM_ZEROBC                 Subr   214                                                                                              

COMPILER OPTIONS BEING USED

       -align noall                          -align nonone
       -align nocommons                      -align nodcommons
       -align noqcommons                     -align nozcommons
       -align records                        -align nosequence
       -align norec1byte                     -align norec2byte
       -align norec4byte                     -align norec8byte
       -align norec16byte                    -align norec32byte
       -align norec64byte                    -align noarray8byte
       -align noarray16byte                  -align noarray32byte
       -align noarray64byte                  -align noarray128byte
       -align noarray256byte                 -altparam
       -assume accuracy_sensitive            -assume nobscc
       -assume nobuffered_io                 -assume nobuffered_stdout
       -assume nobyterecl                    -assume nocontiguous_assumed_shape
       -assume nocontiguous_pointer          -assume nocc_omp
       -assume nocstring                     -assume nodummy_aliases
       -assume nofailed_images               -assume nofpe_summary
       -assume noieee_compares               -assume noieee_fpe_flags
       -assume nominus0                      -assume noold_boz
       -assume old_complex_align             -assume old_unit_star
       -assume old_inquire_recl              -assume old_ldout_format
       -assume old_ldout_zero                -assume noold_logical_assign
       -assume noold_logical_ldio            -assume old_maxminloc
       -assume old_xor                       -assume noprotect_allocates
       -assume protect_constants             -assume noprotect_parens
       -assume realloc_lhs                   -assume norecursion
       -assume split_common                  -assume source_include
       -assume nostd_intent_in               -assume std_minus0_rounding
       -assume nostd_mod_proc_name           -assume std_value
       -assume underscore                    -assume no2underscores
  no   -auto                                 -auto_scalar
  no   -bintext                              -ccdefault default
       -check arg_temp_created               -check assume
       -check bounds                         -check contiguous
       -check format                         -check output_conversion
       -check overflow                       -check pointers
       -check shape                          -check stack

Page 24          Source Listing                  TIM_NEW_TSTEP
2023-01-27 11:38                                 ./program/timestep.f90

       -check teams                          -check uninitialized
       -check udio_iostat                    -coarray-num-procs 0
  no   -coarray-config-file                  -convert native
       -cross_reference                      -D __INTEL_COMPILER=2021
       -D __INTEL_COMPILER_UPDATE=4          -D __unix__
       -D __unix                             -D __linux__
       -D __linux                            -D __gnu_linux__
       -D unix                               -D linux
       -D __ELF__                            -D __x86_64
       -D __x86_64__                         -D __amd64
       -D __amd64__                          -D __INTEL_COMPILER_BUILD_DATE=20210910
       -D __PIC__                            -D __pic__
       -D __INTEL_OFFLOAD                    -D __MMX__
       -D __SSE__                            -D __SSE_MATH__
       -D __SSE2__                           -D __SSE2_MATH__
       -D __pentium4                         -D __pentium4__
       -D __tune_pentium4__                  -double_size 64
  no   -d_lines                         no   -Qdyncom
       -error_limit 30                  no   -f66
  no   -f77rtl                          no   -fast
       -fpscomp nofilesfromcmd               -fpscomp nogeneral
       -fpscomp noioformat                   -fpscomp noldio_spacing
       -fpscomp nologicals              no   -fpconstant
       -fpe0                                 -fprm nearest
  no   -ftz                                  -fp_model noprecise
       -fp_model fast                        -fp_model nostrict
       -fp_model nosource                    -fp_model nodouble
       -fp_model noextended                  -fp_model novery_fast
       -fp_model noexcept                    -fp_model nono_except
       -fp_modbits nofp_contract             -fp_modbits nono_fp_contract
       -fp_modbits nofenv_access             -fp_modbits nono_fenv_access
       -fp_modbits nocx_limited_range        -fp_modbits nono_cx_limited_range
       -fp_modbits noprec_div                -fp_modbits nono_prec_div
       -fp_modbits noprec_sqrt               -fp_modbits nono_prec_sqrt
       -fp_modbits noftz                     -fp_modbits nono_ftz
       -fp_modbits nointrin_limited_range       -fp_modbits nono_intrin_limited_range
       -fp_modbits notrunc_compares          -fp_modbits nono_trunc_compares
       -fp_modbits noieee_nan_compares       -fp_modbits nono_ieee_nan_compares
       -fp_modbits honor_f32_conversion       -fp_modbits nono_honor_f32_conversion
       -fp_modbits honor_f64_conversion       -fp_modbits nono_honor_f64_conversion
       -fp_modbits nono_x87_copy             -fp_modbits nono_no_x87_copy
       -fp_modbits noexception_semantics       -fp_modbits nono_exception_semantics
       -fp_modbits noprecise_libm_functions       -fp_modbits nono_precise_libm_functions
       -heap_arrays 0                   no   -threadprivate_compat
       -free                                 -g2
       -iface nomixed_str_len_arg            -iface nono_mixed_str_len_arg
       -init noarrays                        -init nohuge
       -init noinfinity                      -init nominus_huge
       -init nominus_infinity                -init nominus_tiny
       -init nonan                           -init nosnan
       -init notiny                          -init nozero
  no   -intconstant                          -integer_size 32
  no   -mixed_str_len_arg               no   -module
       -names lowercase                 no   -noinclude
  no   -o                                    -offload-build=host
       -O0                              no   -pad_source
       -real_size 32                    no   -recursive

Page 25          Source Listing                  TIM_NEW_TSTEP
2023-01-27 11:38                                 ./program/timestep.f90

       -reentrancy threaded                  -vec=simd
       -show nofullpath                      -show noinclude
       -show map                             -show options
  no   -syntax_only                     no   -threadcom
  no   -U                               no   -vms
       -w noall                              -w nonone
       -w alignments                         -w nodeclarations
       -w noexternals                        -w general
       -w noignore_bounds                    -w noignore_loc
       -w nointerfaces                       -w noshape
       -w notruncated_source                 -w uncalled
       -w uninitialized                      -w unused
       -w usage                         no   -wrap-margins

       -includepath : /home/intel/oneapi/mpi/2021.4.0//include/,/home/intel/oneapi/dpl/2021.5.0/linux/include/,/home/intel/oneapi/compiler/2021.4.0/linux/include/,
           /usr/local/include/,.f90,./program/.f90,./.f90,/home/intel/oneapi/vpl/2021.6.0/include/.f90,/home/intel/oneapi/tbb/2021.4.0/env/../include/.f90,
           /home/intel/oneapi/mpi/2021.4.0//include/.f90,/home/intel/oneapi/mkl/2021.4.0/include/.f90,/home/intel/oneapi/ipp/2021.4.0/include/.f90,
           /home/intel/oneapi/ippcp/2021.4.0/include/.f90,/home/intel/oneapi/ipp/2021.4.0/include/.f90,/home/intel/oneapi/dpl/2021.5.0/linux/include/.f90,
           /home/intel/oneapi/dpcpp-ct/2021.4.0/include/.f90,/home/intel/oneapi/dnnl/2021.4.0/cpu_dpcpp_gpu_dpcpp/lib/.f90,
           /home/intel/oneapi/dev-utilities/2021.4.0/include/.f90,/home/intel/oneapi/dal/2021.4.0/include/.f90,/home/intel/oneapi/compiler/2021.4.0/linux/include/.f90,
           /home/intel/oneapi/ccl/2021.4.0/include/cpu_gpu_dpcpp/.f90,/home/intel/oneapi/compiler/2021.4.0/linux/bin/intel64/../../compiler/include/intel64/.f90,
           /home/intel/oneapi/compiler/2021.4.0/linux/bin/intel64/../../compiler/include/icc/.f90,/home/intel/oneapi/compiler/2021.4.0/linux/bin/intel64/../../compiler/include/.f90,
           /usr/local/include/.f90,/usr/lib/gcc/x86_64-linux-gnu/9/include/.f90,/usr/include/.f90,/usr/include/.f90,
           /usr/include/x86_64-linux-gnu/.f90,/usr/include/.f90
       -list filename : timestep.lst
  no   -o

COMPILER: Intel(R) Fortran 2021.4.0-2742
